function checkAuthStatus(){const e="true"===localStorage.getItem("adminAuthenticated"),t=window.location.pathname.includes("login.html"),n=window.location.pathname.includes("admin/");e&&t?window.location.href="dashboard.html":e||!n||t?e&&n&&document.body.classList.add("admin-dashboard"):window.location.href="login.html"}function handleLogin(e){e.preventDefault();const t=document.getElementById("username").value,n=document.getElementById("password").value,a=document.getElementById("loginMessage");"admin"===t&&"admin123"===n?(localStorage.setItem("adminAuthenticated","true"),showMessage(a,"Connexion réussie ! Redirection en cours...","success"),setTimeout(()=>{window.location.href="dashboard.html"},1500)):showMessage(a,"Identifiants incorrects. Veuillez réessayer.","error")}function handleLogout(){localStorage.removeItem("adminAuthenticated"),window.location.href="login.html"}function showMessage(e,t,n){e&&(e.textContent=t,e.className="message",e.classList.add(n),e.style.display="block",setTimeout(()=>{e.style.display="none"},5e3))}function setupFileUpload(){const e=document.getElementById("uploadArea"),t=document.getElementById("fileInput");document.getElementById("galleryGrid");function n(e){e.preventDefault(),e.stopPropagation()}function a(){e.classList.add("highlight")}function s(){e.classList.remove("highlight")}["dragenter","dragover","dragleave","drop"].forEach(t=>{e.addEventListener(t,n,!1)}),["dragenter","dragover"].forEach(t=>{e.addEventListener(t,a,!1)}),["dragleave","drop"].forEach(t=>{e.addEventListener(t,s,!1)}),e.addEventListener("drop",function(e){const t=e.dataTransfer;handleFiles(t.files)},!1),e.addEventListener("click",()=>{t.click()}),t.addEventListener("change",function(){handleFiles(this.files)}),loadGalleryImages()}function handleFiles(e){const t=document.getElementById("uploadMessage");if(0===e.length)return void showMessage(t,"Aucun fichier sélectionné.","error");const n=["image/jpeg","image/png","image/gif","image/webp"];Array.from(e).filter(e=>!n.includes(e.type)).length>0?showMessage(t,"Seuls les fichiers JPG, PNG, GIF et WebP sont acceptés.","error"):(showMessage(t,"Téléchargement en cours...","success"),setTimeout(()=>{showMessage(t,"Images téléchargées avec succès !","success"),loadGalleryImages()},1500))}function loadGalleryImages(){const e=document.getElementById("galleryGrid");if(!e)return;e.innerHTML="",[{id:1,src:"../images/gallery/IMG_20250531_121259_952.jpg",featured:!0},{id:2,src:"../images/gallery/IMG_20250531_121300_188.jpg",featured:!1},{id:3,src:"../images/gallery/IMG_20250531_121311_304.jpg",featured:!1},{id:4,src:"../images/gallery/IMG_20250531_121432_334.jpg",featured:!1},{id:5,src:"../images/gallery/IMG_20250531_121451_526.jpg",featured:!1},{id:6,src:"../images/gallery/IMG_20250531_121503_326.jpg",featured:!1}].forEach(t=>{const n=createGalleryItem(t);e.appendChild(n)})}function createGalleryItem(e){const t=document.createElement("div");return t.className="gallery-item",t.dataset.id=e.id,t.innerHTML=`\n        <img src="${e.src}" alt="Image ${e.id}" class="gallery-img">\n        <div class="gallery-actions">\n            <button class="gallery-btn ${e.featured?"featured":""}" \n                    onclick="toggleFeatured(${e.id})" \n                    title="${e.featured?"Mise en avant":"Mettre en avant"}">\n                <i class="fas fa-star"></i>\n            </button>\n            <button class="gallery-btn" onclick="deleteImage(${e.id})" title="Supprimer">\n                <i class="fas fa-trash"></i>\n            </button>\n        </div>\n    `,t}function toggleFeatured(e){const t=document.getElementById("galleryMessage"),n=document.querySelector(`.gallery-item[data-id="${e}"] .gallery-btn:first-child`);if(n){n.classList.contains("featured")?(n.classList.remove("featured"),showMessage(t,"Image retirée de la mise en avant.","success")):(document.querySelectorAll(".gallery-btn.featured").forEach(e=>{e.classList.remove("featured")}),n.classList.add("featured"),showMessage(t,"Image mise en avant avec succès !","success"))}}function deleteImage(e){if(confirm("Êtes-vous sûr de vouloir supprimer cette image ? Cette action est irréversible.")){const t=document.getElementById("galleryMessage"),n=document.querySelector(`.gallery-item[data-id="${e}"]`);n&&(n.style.opacity="0.5",setTimeout(()=>{n.remove(),showMessage(t,"Image supprimée avec succès.","success")},500))}}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("loginForm"),t=document.getElementById("googleSignIn"),n=document.getElementById("showEmailLogin"),a=document.querySelector(".toggle-password"),s=document.getElementById("loginMessage"),o=firebase.auth(),i=new firebase.auth.GoogleAuthProvider;o.onAuthStateChanged(e=>{e?(window.location.pathname.includes("login.html")||window.location.pathname.endsWith("admin/")||window.location.pathname.endsWith("admin"))&&(window.location.href="dashboard.html"):window.location.pathname.includes("login.html")||window.location.pathname.endsWith("admin/")||window.location.pathname.endsWith("admin")||(window.location.href="index.html")}),t&&t.addEventListener("click",async function(){try{const e=await o.signInWithPopup(i),t=["ifrasoleil.@gmail.com"];if(t.length>0&&!t.includes(e.user.email))return await o.signOut(),void r(s,"Accès non autorisé avec cet email.","error");window.location.href="dashboard.html"}catch(e){console.error("Erreur de connexion avec Google:",e),r(s,"Échec de la connexion avec Google. Veuillez réessayer.","error")}}),n&&n.addEventListener("click",function(){e.style.display="block",this.style.display="none",document.querySelector(".social-login").style.display="none"}),e&&e.addEventListener("submit",async function(e){e.preventDefault();const t=document.getElementById("email").value,n=document.getElementById("password").value;try{await o.signInWithEmailAndPassword(t,n),window.location.href="dashboard.html"}catch(e){console.error("Erreur de connexion:",e);let t="Échec de la connexion. Veuillez vérifier vos identifiants.";"auth/user-not-found"===e.code||"auth/wrong-password"===e.code?t="Email ou mot de passe incorrect.":"auth/too-many-requests"===e.code&&(t="Trop de tentatives échouées. Veuillez réessayer plus tard."),r(s,t,"error")}});const l=document.querySelector(".logout-btn");l&&l.addEventListener("click",async function(){try{await o.signOut(),window.location.href="index.html"}catch(e){console.error("Erreur lors de la déconnexion:",e),r(s,"Une erreur est survenue lors de la déconnexion.","error")}}),a&&a.addEventListener("click",function(){const e=document.getElementById("password"),t=this.querySelector("i");"password"===e.type?(e.type="text",t.classList.remove("fa-eye"),t.classList.add("fa-eye-slash")):(e.type="password",t.classList.remove("fa-eye-slash"),t.classList.add("fa-eye"))});function r(e,t,n){e&&(e.textContent=t,e.className="message",e.classList.add(n),e.style.display="block",setTimeout(()=>{e.style.display="none"},5e3))}document.getElementById("uploadArea")&&setupFileUpload()}),window.toggleFeatured=toggleFeatured,window.deleteImage=deleteImage;